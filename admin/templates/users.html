{% extends "base.html" %}
{% block title %}Users - ThePred Admin{% endblock %}
{% block content %}
<div class="max-w-7xl">
    <h1 class="text-3xl font-bold mb-8">User Management</h1>
    <div class="bg-dark-800 rounded-lg overflow-hidden">
        <table class="w-full">
            <thead class="bg-dark-700">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400">ID</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400">Username</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400">PRED</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400">Bets</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400">Rank</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-400">Created</th>
                </tr>
            </thead>
            <tbody id="users-tbody"></tbody>
        </table>
    </div>
</div>
{% endblock %}
{% block scripts %}
<script>
async function loadUsers() {
    const tbody = document.getElementById('users-tbody');
    const response = await fetch(`${API_URL}/admin/users?limit=100`);
    const users = await response.json();
    tbody.innerHTML = users.map(u => `
        <tr class="border-t border-gray-800 hover:bg-dark-700 cursor-pointer" onclick="viewUser(${u.id})">
            <td class="px-6 py-4">#${u.id}</td>
            <td class="px-6 py-4">${u.username || u.first_name || 'N/A'}</td>
            <td class="px-6 py-4">${formatNumber(u.pred_balance)}</td>
            <td class="px-6 py-4">${u.total_bets}</td>
            <td class="px-6 py-4"><span class="px-2 py-1 bg-yellow-600 rounded text-xs">${u.rank}</span></td>
            <td class="px-6 py-4 text-sm text-gray-400">${formatDate(u.created_at)}</td>
        </tr>
    `).join('');
}
async function viewUser(id) {
    const response = await fetch(`${API_URL}/admin/users/${id}/activity`);
    const data = await response.json();
    alert(`User ${data.username}\nBalance: ${data.balances.pred} PRED\nWin Rate: ${data.stats.win_rate}%\nTotal Bets: ${data.stats.total_bets}`);
}
loadUsers();
</script>
{% endblock %}
