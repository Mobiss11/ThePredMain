# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. ‚ùå ‚Üí ‚úÖ –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ —Å–æ–±—ã—Ç–∏—è
**–ë—ã–ª–æ**: `"object bytes can't be used in 'await' expression"`
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –£–±—Ä–∞–ª `await` –∏–∑ `photo.read()` –≤ `webapp/main.py:515`

### 2. ‚ùå ‚Üí ‚úÖ –ö–Ω–æ–ø–∫–∏ Approve/Reject –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
**–ë—ã–ª–æ**: `moderation_status = "undefined"`, –∫–Ω–æ–ø–æ–∫ –Ω–µ—Ç
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `|| !market.moderation_status` –≤ `admin/templates/markets.html`

### 3. ‚ùå ‚Üí ‚úÖ –ë–∞–ª–∞–Ω—Å "..." —á–µ—Ä–µ–∑ Telegram
**–ë—ã–ª–æ**: –ü—Ä–æ—Ñ–∏–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "..."
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `/api/profile`, –æ–±—Ä–∞–±–æ—Ç–∫–∞ 401 –æ—à–∏–±–∫–∏

### 4. ‚ö†Ô∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–±–µ—Ä–Ω—É—Ç–æ –≤ DOMContentLoaded

---

## üì¶ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

```
webapp/main.py                      ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ photo.read()
webapp/static/js/app.js            ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + –æ–±—Ä–∞–±–æ—Ç–∫–∞ 401
webapp/templates/create_event.html ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
admin/templates/base.html          ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ formatNumber
admin/templates/users.html         ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ + –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
admin/templates/markets.html       ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
```

---

## üîß –®–∞–≥–∏ –¥–µ–ø–ª–æ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

### 1. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π scp, rsync, git pull –∏–ª–∏ –ª—é–±–æ–π –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–±
# –£–±–µ–¥–∏—Å—å —á—Ç–æ –≤—Å–µ 6 —Ñ–∞–π–ª–æ–≤ –≤—ã—à–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```

### 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
```bash
cd /path/to/ThePred

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
docker-compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –∑–∞–ø—É—â–µ–Ω—ã
docker-compose ps
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
```bash
# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ webapp
docker-compose logs -f webapp

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
# ==================================================
# WEBAPP CONFIGURATION:
# DEV_MODE: True (from env: true)
# API_URL: http://backend:8000
# BOT_USERNAME: The_Pred_Bot
# ==================================================
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Å —Ñ–æ—Ç–æ
1. –û—Ç–∫—Ä–æ–π https://thepred.tech/create-event
2. –ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É + –∑–∞–≥—Ä—É–∑–∏ —Ñ–æ—Ç–æ
3. –ù–∞–∂–º–∏ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å"
4. **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –ú–æ–¥–∞–ª "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é!" ‚úÖ
5. **–ë—ã–ª–æ**: –û—à–∏–±–∫–∞ `object bytes...` ‚ùå

### –¢–µ—Å—Ç 2: –ú–æ–¥–µ—Ä–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è
1. –û—Ç–∫—Ä–æ–π https://admin.thepred.tech/markets
2. –ö–ª–∏–∫–Ω–∏ "Pending Moderation"
3. **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –í–∏–¥–Ω—ã –∫–Ω–æ–ø–∫–∏ "Approve" –∏ "Reject" ‚úÖ
4. **–ë—ã–ª–æ**: –¢–æ–ª—å–∫–æ –∫–Ω–æ–ø–∫–∞ "Cancel" ‚ùå
5. –ù–∞–∂–º–∏ "Approve" ‚Üí –°–æ–±—ã—Ç–∏–µ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫–µ

### –¢–µ—Å—Ç 3: –ë–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ Telegram
1. –û—Ç–∫—Ä–æ–π –±–æ—Ç–∞ –≤ Telegram
2. –ù–∞–∂–º–∏ "–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
3. **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –ë–∞–ª–∞–Ω—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —á–∏—Å–ª–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä "10.00K") ‚úÖ
4. **–ë—ã–ª–æ**: –ë–∞–ª–∞–Ω—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "..." ‚ùå

**–ï—Å–ª–∏ –±–∞–ª–∞–Ω—Å –≤—Å—ë —Ä–∞–≤–Ω–æ "..."**:
- –û—Ç–∫—Ä–æ–π F12 ‚Üí Console
- –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏:
  ```
  [/api/profile] No user_id in session!
  Not authenticated! User needs to login through Telegram or dev_login
  ```
- –ó–Ω–∞—á–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω —á–µ—Ä–µ–∑ Telegram auth
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ bot –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `initData`

### –¢–µ—Å—Ç 4: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∞–¥–º–∏–Ω–∫–µ
1. –û—Ç–∫—Ä–æ–π https://admin.thepred.tech/users
2. **–û–∂–∏–¥–∞–µ—Ç—Å—è**: –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞–≥—Ä—É–∂–µ–Ω ‚úÖ
3. **–ë—ã–ª–æ**: –û—à–∏–±–∫–∞ `num.toFixed is not a function` ‚ùå
4. –ù–∞–∂–º–∏ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –Ω–∞ –ª—é–±–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
5. –ò–∑–º–µ–Ω–∏ PRED balance
6. –ù–∞–∂–º–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
7. **–û—Ç–∫—Ä–æ–π F12 ‚Üí Console** –∏ —Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏:
   ```
   Edit form submitted
   Updating user: {userId: 1, predBalance: 20000, ...}
   Sending balance update to: /admin/users/1/balance
   Balance response status: 200
   User updated successfully
   ```

---

## üêõ –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ–±—ã—Ç–∏—è –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å —Ñ–æ—Ç–æ
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ MinIO –∑–∞–ø—É—â–µ–Ω:
```bash
docker-compose ps | grep minio
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–Ω–æ–ø–∫–∏ Approve/Reject –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**:
1. –û—Ç–∫—Ä–æ–π F12 ‚Üí Console –≤ admin panel
2. –°–º–æ—Ç—Ä–∏ –ª–æ–≥–∏:
   ```
   Markets loaded: [{id: 1, moderation_status: undefined, ...}]
   Market 1: status=open, moderation_status=PENDING
   ```
3. –ï—Å–ª–∏ moderation_status = null –≤ –±–∞–∑–µ, –≤—ã–ø–æ–ª–Ω–∏ SQL:
   ```sql
   UPDATE markets SET moderation_status = 'PENDING' WHERE moderation_status IS NULL;
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ Telegram –≤—Å—ë —Ä–∞–≤–Ω–æ "..."
**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ webapp:
   ```bash
   docker-compose logs -f webapp
   ```
2. –°–º–æ—Ç—Ä–∏ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:
   ```
   [/api/profile] Session user_id: None, All session: {}
   [/api/profile] No user_id in session!
   ```
3. –ó–Ω–∞—á–∏—Ç auth —á–µ—Ä–µ–∑ Telegram –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
4. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ `auth.html` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç initData

### –ü—Ä–æ–±–ª–µ–º–∞: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ**:
1. –û—Ç–∫—Ä–æ–π F12 ‚Üí Console
2. –°–º–æ—Ç—Ä–∏ –æ—à–∏–±–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ admin/main.py –∏–º–µ–µ—Ç proxy routes:
   - `/admin/users/{id}/balance`
   - `/admin/users/{id}/rank`

---

## üìä –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ backend —Ä–∞–±–æ—Ç–∞–µ—Ç
curl http://localhost:8000/docs

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ backend
curl http://localhost:8000/admin/users?limit=10

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å admin proxy
curl http://localhost:8002/admin/users?limit=10

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è (—á–µ—Ä–µ–∑ curl —Å —Ñ–æ—Ç–æ)
curl -X POST http://localhost:8001/api/markets/create-event \
  -F "user_id=1" \
  -F "title=Test Event" \
  -F "description=Test" \
  -F "category=Sports" \
  -F "resolve_date=2025-12-31T23:59"
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º:

- [ ] –í—Å–µ 6 —Ñ–∞–π–ª–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] –í—ã–ø–æ–ª–Ω–µ–Ω `docker-compose down && docker-compose up -d`
- [ ] –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤ —Å—Ç–∞—Ç—É—Å–µ "Up" (`docker-compose ps`)
- [ ] –õ–æ–≥–∏ webapp –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç WEBAPP CONFIGURATION
- [ ] –õ–æ–≥–∏ backend –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –û—Ç–∫—Ä—ã–ª F12 ‚Üí Console –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏

---

**–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è —Å–∫–∏–Ω—å:**
1. –°–∫—Ä–∏–Ω—à–æ—Ç –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è
2. –°–∫—Ä–∏–Ω—à–æ—Ç –∞–¥–º–∏–Ω–∫–∏ Markets —Å –∫–Ω–æ–ø–∫–∞–º–∏
3. –°–∫—Ä–∏–Ω—à–æ—Ç –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ Telegram
4. –í—ã–≤–æ–¥ `docker-compose logs --tail=100 webapp`
