# ‚ö° –ë–´–°–¢–†–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï - –í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!

## üîß –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
1. ‚úÖ –ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–∏–≥—Ä–∞—Ü–∏–π Alembic
2. ‚úÖ –û—à–∏–±–∫–∞ Path –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ `/rewards/{period}`

## üìã –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (5 –º–∏–Ω—É—Ç):

### SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
```bash
ssh your-server
```

### –í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ –ø–æ—Ä—è–¥–∫—É:

```bash
# 1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç
cd ~/ThePredMain

# 2. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backend
pm2 stop backend

# 3. Pull –∏–∑–º–µ–Ω–µ–Ω–∏–π (3 –Ω–æ–≤—ã—Ö –∫–æ–º–º–∏—Ç–∞)
git pull origin main

# 4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î
cd backend
POSTGRES_HOST=localhost alembic upgrade head

# 5. –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ—Ä–µ–Ω—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
cd ..
pm2 restart backend

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ (–¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫)
pm2 logs backend --lines 20
```

---

## ‚úÖ –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –ª–æ–≥–∞—Ö:

**–•–û–†–û–®–û (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ç–∞–∫):**
```
‚úì INFO  [alembic.runtime.migration] Running upgrade update_mission_icon_size -> b8c9d4e5f6a7
‚úì INFO:     Started server process
‚úì INFO:     Waiting for application startup.
‚úì INFO:     Application startup complete.
‚úì INFO:     Uvicorn running on http://0.0.0.0:8000
```

**–ü–õ–û–•–û (–µ—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —ç—Ç–æ - —Å–æ–æ–±—â–∏—Ç–µ):**
```
‚úó AssertionError: Cannot use Query for path param
‚úó Multiple head revisions are present
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–¥–µ—Ä–±–æ—Ä–¥
curl https://thepred.tech/api/leaderboard?period=week

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—ã
curl https://thepred.tech/api/leaderboard/rewards/week

# –û–±–∞ –¥–æ–ª–∂–Ω—ã –≤–µ—Ä–Ω—É—Ç—å JSON (–Ω–µ 404, –Ω–µ 500)
```

---

## üìä –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:

### Commit 1: `823474c`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫–æ–Ω—Ñ–ª–∏–∫—Ç –º–∏–≥—Ä–∞—Ü–∏–π Alembic
- `leaderboard_rewards` —Ç–µ–ø–µ—Ä—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `update_mission_icon_size`

### Commit 2: `797517a` ‚ö° –ì–õ–ê–í–ù–´–ô
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `period` –≤ `/rewards/{period}`
- –ó–∞–º–µ–Ω–µ–Ω `Query` –Ω–∞ `Path`
- Backend —Ç–µ–ø–µ—Ä—å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

### Commit 3: `61c4d2e`
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üÜò –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
```bash
pm2 logs backend --lines 50
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ.

### 404 –Ω–∞ /api/leaderboard/rewards/week:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω
pm2 status

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
pm2 restart backend
```

### –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å:
```bash
cd ~/ThePredMain/backend
POSTGRES_HOST=localhost alembic current
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: b8c9d4e5f6a7 (head)
```

---

## ‚è±Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~5 –º–∏–Ω—É—Ç

**–°—Ç–∞—Ç—É—Å**: üö® CRITICAL FIX - –í—ã–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ

**–î–∞—Ç–∞**: 6 –Ω–æ—è–±—Ä—è 2025
